import{d as B,r as b,o as A,c as g,w as E,b as n,e,j as v,f,i as p,u as c,t as o,F as U,m as O,X as q,y as m,z as h,A as z,B as L,C as W,q as C,h as l,x as X}from"./index-CBlyhhB_.js";import{u as G}from"./paymentsStore-DGeoRBLV.js";import{R as H}from"./refresh-ccw-Z9glMWGs.js";const J={class:"dark:bg-gray-900"},K={class:"mb-6 flex justify-between items-center"},Q={class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white font-medium rounded-lg transition-colors"},Y={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden"},Z={key:0,class:"flex justify-center items-center h-64"},ee={key:1,class:"text-red-500 dark:text-red-400 text-center py-8"},te={key:2,class:"text-center py-8 text-gray-500 dark:text-gray-400"},ae={key:3},re={class:"overflow-x-auto"},se={class:"w-full border-collapse"},oe={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},de={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ne={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},le={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ie=["onClick"],ue={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ge={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ce={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ye={class:"px-6 py-4 whitespace-nowrap"},be={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},pe={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-between items-center border-t border-gray-200 dark:border-gray-600"},xe={class:"text-sm text-gray-500 dark:text-gray-400"},ve={class:"font-medium"},me={class:"font-medium"},ke={class:"font-medium"},fe={class:"flex space-x-2"},he=["disabled"],we=["disabled"],_e={key:0,class:"mt-8 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 p-6"},Re={class:"flex justify-between items-center mb-6"},Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ie={class:"mb-4"},Pe={class:"flex"},De={class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 border border-l-0 border-gray-200 dark:border-gray-700 rounded-r-lg text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"},Ne={class:"mb-4"},Se={class:"relative"},je={class:"mb-4"},Te={key:0,class:"mb-4"},Ve={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},Fe={key:0,class:"space-y-3"},$e={class:"flex justify-between"},Me={class:"font-medium dark:text-white"},Be={class:"flex justify-between"},Ae={class:"font-medium dark:text-white"},Ee={class:"flex justify-between"},Ue={class:"font-medium dark:text-white"},Oe={class:"flex justify-between"},qe={class:"font-medium dark:text-white"},ze={class:"flex justify-between"},Le={class:"font-medium"},We={class:"pt-4 border-t border-gray-200 dark:border-gray-600 text-sm"},Xe={key:0,class:"text-red-500 dark:text-red-400 mb-2"},Ge={key:1,class:"text-yellow-500 dark:text-yellow-400"},He={key:1,class:"text-center py-6 text-gray-500 dark:text-gray-400"},Je={class:"mt-6 flex justify-end space-x-3"},Ke=["disabled"],at=B({__name:"RefundsView",setup(Qe){const I=X(),k=G(),{isLoading:P,error:w,fetchRefunds:D,fetchTransactions:N}=k,i=b(1),y=b(10),x=b(!1),d=b(null),a=b({transactionId:"",amount:0,reason:"",otherReason:""});A(async()=>{try{await Promise.all([D(),N()])}catch(s){console.error("Error fetching data:",s)}});const u=g(()=>k.refunds||[]),S=g(()=>{const s=(i.value-1)*y.value,t=s+y.value;return u.value.slice(s,t)}),j=g(()=>Math.ceil(u.value.length/y.value)),T=g(()=>u.value.length===0?0:(i.value-1)*y.value+1),V=g(()=>{const s=i.value*y.value;return s>u.value.length?u.value.length:s}),F=g(()=>a.value.transactionId&&a.value.amount>0&&a.value.reason&&(a.value.reason!=="other"||a.value.otherReason)&&d.value),_=s=>{const t=new Date(s);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)},R=s=>{switch(s){case"completed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";case"captured":case"settled":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"authorized":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"voided":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";case"refunded":case"partially_refunded":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},$=s=>{I.push(`/payments/transactions/${s}`)},M=()=>{console.log("Processing refund:",{transactionId:a.value.transactionId,amount:a.value.amount,reason:a.value.reason==="other"?a.value.otherReason:a.value.reason}),a.value={transactionId:"",amount:0,reason:"",otherReason:""},d.value=null,x.value=!1};return E(()=>a.value.transactionId,s=>{if(s){const t=k.getTransactionById(s);d.value=t||null,t&&(a.value.amount=t.amount)}else d.value=null}),(s,t)=>(l(),n("div",J,[e("header",K,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-3xl font-bold dark:text-white"},"Refunds"),e("p",{class:"text-gray-500 dark:text-gray-400 mt-2"},"Process and manage payment refunds")],-1)),e("button",Q,[f(c(H),{class:"w-5 h-5 mr-1 inline-block"}),t[8]||(t[8]=p(" New Refund "))])]),e("section",Y,[c(P)?(l(),n("div",Z,t[10]||(t[10]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-100"},null,-1)]))):c(w)?(l(),n("div",ee,o(c(w)),1)):u.value.length===0?(l(),n("div",te," No refunds found. ")):(l(),n("div",ae,[e("div",re,[e("table",se,[t[11]||(t[11]=e("thead",null,[e("tr",{class:"bg-gray-50 dark:bg-gray-700 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},[e("th",{class:"px-6 py-3"},"Refund ID"),e("th",{class:"px-6 py-3"},"Date"),e("th",{class:"px-6 py-3"},"Original Transaction"),e("th",{class:"px-6 py-3"},"Payment Method"),e("th",{class:"px-6 py-3"},"Amount"),e("th",{class:"px-6 py-3"},"Reason"),e("th",{class:"px-6 py-3"},"Status"),e("th",{class:"px-6 py-3"},"Refunded By")])],-1)),e("tbody",oe,[(l(!0),n(U,null,O(S.value,r=>(l(),n("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",de,o(r.id),1),e("td",ne,o(_(r.date)),1),e("td",le,[e("button",{class:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300",onClick:Ye=>$(r.transactionId)},o(r.transactionId),9,ie)]),e("td",ue,o(r.paymentMethodName),1),e("td",ge,"$"+o(r.amount.toFixed(2)),1),e("td",ce,o(r.reason),1),e("td",ye,[e("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",R(r.status)])},o(r.status),3)]),e("td",be,o(r.refundedBy),1)]))),128))])])]),e("div",pe,[e("div",xe,[t[12]||(t[12]=p(" Showing ")),e("span",ve,o(T.value),1),t[13]||(t[13]=p(" to ")),e("span",me,o(V.value),1),t[14]||(t[14]=p(" of ")),e("span",ke,o(u.value.length),1),t[15]||(t[15]=p(" refunds "))]),e("div",fe,[e("button",{class:"px-3 py-1 rounded border border-gray-300 dark:border-gray-600 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:i.value===1,onClick:t[0]||(t[0]=r=>i.value--)}," Previous ",8,he),e("button",{class:"px-3 py-1 rounded border border-gray-300 dark:border-gray-600 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:i.value===j.value,onClick:t[1]||(t[1]=r=>i.value++)}," Next ",8,we)])])]))]),x.value?(l(),n("section",_e,[e("div",Re,[t[16]||(t[16]=e("h2",{class:"text-xl font-bold dark:text-white"},"Process New Refund",-1)),e("button",{onClick:t[2]||(t[2]=r=>x.value=!1),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[f(c(q),{class:"w-5 h-5"})])]),e("div",Ce,[e("div",null,[e("div",Ie,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Transaction ID ",-1)),e("div",Pe,[m(e("input",{type:"text",placeholder:"Enter transaction ID",class:"flex-1 px-4 py-2 rounded-l-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[3]||(t[3]=r=>a.value.transactionId=r)},null,512),[[h,a.value.transactionId]]),e("button",De,[f(c(z),{class:"w-5 h-5"})])])]),e("div",Ne,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Refund Amount ",-1)),e("div",Se,[t[18]||(t[18]=e("span",{class:"absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500 dark:text-gray-400"}," $ ",-1)),m(e("input",{type:"number",placeholder:"0.00",step:"0.01",class:"w-full pl-8 px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[4]||(t[4]=r=>a.value.amount=r)},null,512),[[h,a.value.amount]])])]),e("div",je,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Refund Reason ",-1)),m(e("select",{class:"w-full px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[5]||(t[5]=r=>a.value.reason=r)},t[20]||(t[20]=[W('<option value="">Select a reason</option><option value="customer_request">Customer Request</option><option value="duplicate_charge">Duplicate Charge</option><option value="fraudulent">Fraudulent Charge</option><option value="product_defective">Product Defective</option><option value="product_not_received">Product Not Received</option><option value="wrong_amount">Wrong Amount</option><option value="other">Other</option>',8)]),512),[[L,a.value.reason]])]),a.value.reason==="other"?(l(),n("div",Te,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Other Reason ",-1)),m(e("textarea",{rows:"3",placeholder:"Provide details for the refund",class:"w-full px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[6]||(t[6]=r=>a.value.otherReason=r)},null,512),[[h,a.value.otherReason]])])):v("",!0)]),e("div",Ve,[t[28]||(t[28]=e("h3",{class:"font-medium mb-3 dark:text-white"},"Transaction Details",-1)),d.value?(l(),n("div",Fe,[e("div",$e,[t[23]||(t[23]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Date:",-1)),e("span",Me,o(_(d.value.date)),1)]),e("div",Be,[t[24]||(t[24]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Customer:",-1)),e("span",Ae,o(d.value.customerId),1)]),e("div",Ee,[t[25]||(t[25]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Payment Method:",-1)),e("span",Ue,o(d.value.paymentMethodName),1)]),e("div",Oe,[t[26]||(t[26]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Original Amount:",-1)),e("span",qe,"$"+o(d.value.amount.toFixed(2)),1)]),e("div",ze,[t[27]||(t[27]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Status:",-1)),e("span",Le,[e("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",R(d.value.status)])},o(d.value.status),3)])]),e("div",We,[a.value.amount>d.value.amount?(l(),n("div",Xe," Warning: Refund amount exceeds the original transaction amount. ")):v("",!0),["captured","settled"].includes(d.value.status)?v("",!0):(l(),n("div",Ge," Note: This transaction may not be eligible for refund due to its current status. "))])])):(l(),n("div",He," Enter a transaction ID to view details "))])]),e("div",Je,[e("button",{onClick:t[7]||(t[7]=r=>x.value=!1),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}," Cancel "),e("button",{class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",disabled:!F.value,onClick:M}," Process Refund ",8,Ke)])])):v("",!0)]))}});export{at as default};
