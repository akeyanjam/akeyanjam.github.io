import{u as U}from"./paymentsStore-DGeoRBLV.js";import{C as X}from"./circle-plus-DgIFsBWy.js";import{d as G,r as m,o as J,c as l,b as n,e as t,j as g,f as A,i as y,u as p,t as a,F as T,m as R,X as K,q as b,h as d}from"./index-CBlyhhB_.js";const Q={class:"dark:bg-gray-900"},W={class:"mb-6 flex justify-between items-center"},Y={class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white font-medium rounded-lg transition-colors"},Z={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},tt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 p-6"},et={class:"flex items-end justify-between"},st={class:"text-3xl font-bold text-blue-600 dark:text-blue-400"},at={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 p-6"},rt={class:"flex items-end justify-between"},ot={class:"text-3xl font-bold text-green-600 dark:text-green-400"},nt={class:"text-sm text-gray-500 dark:text-gray-400"},dt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 p-6"},it={class:"flex items-end justify-between"},lt={class:"text-3xl font-bold text-amber-600 dark:text-amber-400"},ct={class:"text-sm text-gray-500 dark:text-gray-400"},gt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden"},ut={key:0,class:"flex justify-center items-center h-64"},xt={key:1,class:"text-red-500 dark:text-red-400 text-center py-8"},yt={key:2,class:"text-center py-8 text-gray-500 dark:text-gray-400"},pt={key:3},bt={class:"overflow-x-auto"},vt={class:"w-full border-collapse"},ft={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},mt={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},kt={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ht={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},_t={class:"px-6 py-4 whitespace-nowrap"},wt={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},Bt={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},Ct={key:0},jt={key:1},$t={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},At=["onClick"],Tt=["onClick"],Rt=["onClick"],Ft={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-between items-center border-t border-gray-200 dark:border-gray-600"},Dt={class:"text-sm text-gray-500 dark:text-gray-400"},St={class:"font-medium"},Vt={class:"font-medium"},Nt={class:"font-medium"},Pt={class:"flex space-x-2"},It=["disabled"],Mt=["disabled"],Et={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ht={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Lt={class:"flex justify-between items-center mb-4"},qt={key:0,class:"text-sm"},zt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Ot={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},Ut={class:"space-y-2"},Xt={class:"flex justify-between"},Gt={class:"font-medium dark:text-white"},Jt={class:"flex justify-between"},Kt={class:"font-medium dark:text-white"},Qt={class:"flex justify-between"},Wt={class:"font-medium"},Yt={class:"flex justify-between"},Zt={class:"font-medium dark:text-white"},te={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},ee={class:"space-y-2"},se={class:"flex justify-between"},ae={class:"font-medium dark:text-white"},re={class:"flex justify-between"},oe={class:"font-medium dark:text-white"},ne={class:"flex justify-between"},de={class:"font-medium dark:text-white"},ie={class:"flex justify-between"},le={class:"font-medium dark:text-white"},ce={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},ge={class:"space-y-2"},ue={class:"flex justify-between"},xe={class:"font-medium dark:text-white"},ye={class:"flex justify-between"},pe={class:"font-medium dark:text-white"},be={class:"flex justify-between"},ve={class:"flex justify-between"},fe={class:"font-medium dark:text-white"},me={class:"mb-6"},ke={class:"bg-gray-50 dark:bg-gray-700 rounded-lg overflow-hidden"},he={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-600"},_e={class:"divide-y divide-gray-200 dark:divide-gray-600"},we={class:"px-4 py-2 whitespace-nowrap dark:text-white"},Be={class:"px-4 py-2 whitespace-nowrap dark:text-white"},Ce={class:"px-4 py-2 whitespace-nowrap dark:text-white"},je={class:"px-4 py-2 whitespace-nowrap dark:text-white"},$e={key:0,class:"mb-6"},Ae={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},Te={class:"text-gray-600 dark:text-gray-300"},Re={class:"flex justify-end space-x-3 mt-6"},Ne=G({__name:"ReconciliationView",setup(Fe){const k=U(),{isLoading:F,error:h,fetchReconciliationBatches:D}=k,c=m(1),x=m(10),u=m(!1),o=m(null);J(async()=>{try{await D()}catch(s){console.error("Error fetching reconciliation batches:",s)}});const i=l(()=>k.reconciliationBatches||[]),S=l(()=>i.value.filter(s=>s.status==="open").length),V=l(()=>{const s=new Date;return s.setHours(0,0,0,0),i.value.filter(e=>e.status==="reconciled"&&new Date(e.reconciledAt||"").setHours(0,0,0,0)===s.getTime()).length}),N=l(()=>{const s=new Date;return s.setHours(0,0,0,0),i.value.filter(e=>e.status==="reconciled"&&new Date(e.reconciledAt||"").setHours(0,0,0,0)===s.getTime()).reduce((e,v)=>e+v.totalAmount,0)}),P=l(()=>i.value.filter(s=>s.status==="closed").reduce((s,e)=>s+e.totalAmount,0)),I=l(()=>i.value.filter(s=>s.status==="closed").reduce((s,e)=>s+e.totalTransactions,0)),M=l(()=>{const s=(c.value-1)*x.value,e=s+x.value;return i.value.slice(s,e)}),E=l(()=>Math.ceil(i.value.length/x.value)),H=l(()=>i.value.length===0?0:(c.value-1)*x.value+1),L=l(()=>{const s=c.value*x.value;return s>i.value.length?i.value.length:s}),_=s=>{const e=new Date(s);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)},w=s=>{switch(s){case"open":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";case"closed":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"reconciled":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},q=s=>!s.differences||s.differences.variance===0?"dark:text-gray-200":s.differences.variance<0?"text-red-600 dark:text-red-400":"text-orange-600 dark:text-orange-400",z=s=>!s.differences||s.differences.variance===0?"text-green-600 dark:text-green-400":s.differences.variance<0?"text-red-600 dark:text-red-400":"text-orange-600 dark:text-orange-400",O=s=>{const e=k.getReconciliationBatchById(s);e&&(o.value=e,u.value=!0)},B=s=>{console.log(`Closing batch ${s}`)},C=s=>{console.log(`Reconciling batch ${s}`)};return(s,e)=>{var v,j,$;return d(),n("div",Q,[t("header",W,[e[7]||(e[7]=t("div",null,[t("h1",{class:"text-3xl font-bold dark:text-white"},"Payment Reconciliation"),t("p",{class:"text-gray-500 dark:text-gray-400 mt-2"},"Balance and reconcile payment transactions")],-1)),t("button",Y,[A(p(X),{class:"w-5 h-5 mr-1 inline-block"}),e[6]||(e[6]=y(" New Reconciliation Batch "))])]),t("section",Z,[t("div",tt,[e[9]||(e[9]=t("h3",{class:"text-lg font-bold mb-2 dark:text-white"},"Open Batches",-1)),t("div",et,[t("span",st,a(S.value),1),e[8]||(e[8]=t("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Requires attention",-1))])]),t("div",at,[e[10]||(e[10]=t("h3",{class:"text-lg font-bold mb-2 dark:text-white"},"Reconciled Today",-1)),t("div",rt,[t("span",ot,"$"+a(N.value.toFixed(2)),1),t("span",nt,a(V.value)+" batches",1)])]),t("div",dt,[e[11]||(e[11]=t("h3",{class:"text-lg font-bold mb-2 dark:text-white"},"Needs Reconciliation",-1)),t("div",it,[t("span",lt,"$"+a(P.value.toFixed(2)),1),t("span",ct,a(I.value)+" transactions",1)])])]),t("section",gt,[p(F)?(d(),n("div",ut,e[12]||(e[12]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-100"},null,-1)]))):p(h)?(d(),n("div",xt,a(p(h)),1)):i.value.length===0?(d(),n("div",yt," No reconciliation batches found. ")):(d(),n("div",pt,[t("div",bt,[t("table",vt,[e[13]||(e[13]=t("thead",null,[t("tr",{class:"bg-gray-50 dark:bg-gray-700 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},[t("th",{class:"px-6 py-3"},"Batch ID"),t("th",{class:"px-6 py-3"},"Date"),t("th",{class:"px-6 py-3"},"Location"),t("th",{class:"px-6 py-3"},"Status"),t("th",{class:"px-6 py-3"},"Transactions"),t("th",{class:"px-6 py-3"},"Total Amount"),t("th",{class:"px-6 py-3"},"Variance"),t("th",{class:"px-6 py-3"},"Actions")])],-1)),t("tbody",ft,[(d(!0),n(T,null,R(M.value,r=>(d(),n("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",mt,a(r.id),1),t("td",kt,a(_(r.date)),1),t("td",ht,a(r.locationId),1),t("td",_t,[t("span",{class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",w(r.status)])},a(r.status),3)]),t("td",wt,a(r.totalTransactions),1),t("td",Bt,"$"+a(r.totalAmount.toFixed(2)),1),t("td",{class:b(["px-6 py-4 whitespace-nowrap",q(r)])},[r.differences?(d(),n("span",Ct," $"+a(r.differences.variance.toFixed(2)),1)):(d(),n("span",jt,"—"))],2),t("td",$t,[t("button",{class:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3",onClick:f=>O(r.id)}," View ",8,At),r.status==="open"?(d(),n("button",{key:0,class:"text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300",onClick:f=>B(r.id)}," Close ",8,Tt)):g("",!0),r.status==="closed"?(d(),n("button",{key:1,class:"text-amber-600 dark:text-amber-400 hover:text-amber-900 dark:hover:text-amber-300",onClick:f=>C(r.id)}," Reconcile ",8,Rt)):g("",!0)])]))),128))])])]),t("div",Ft,[t("div",Dt,[e[14]||(e[14]=y(" Showing ")),t("span",St,a(H.value),1),e[15]||(e[15]=y(" to ")),t("span",Vt,a(L.value),1),e[16]||(e[16]=y(" of ")),t("span",Nt,a(i.value.length),1),e[17]||(e[17]=y(" batches "))]),t("div",Pt,[t("button",{class:"px-3 py-1 rounded border border-gray-300 dark:border-gray-600 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:c.value===1,onClick:e[0]||(e[0]=r=>c.value--)}," Previous ",8,It),t("button",{class:"px-3 py-1 rounded border border-gray-300 dark:border-gray-600 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:c.value===E.value,onClick:e[1]||(e[1]=r=>c.value++)}," Next ",8,Mt)])])]))]),u.value?(d(),n("div",Et,[t("div",Ht,[t("div",Lt,[e[18]||(e[18]=t("h3",{class:"text-xl font-bold dark:text-white"},"Reconciliation Batch Details",-1)),t("button",{onClick:e[2]||(e[2]=r=>u.value=!1),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[A(p(K),{class:"w-5 h-5"})])]),o.value?(d(),n("div",qt,[t("div",zt,[t("div",Ot,[e[23]||(e[23]=t("h4",{class:"font-medium text-gray-700 dark:text-gray-300 mb-2"},"Batch Information",-1)),t("div",Ut,[t("div",Xt,[e[19]||(e[19]=t("span",{class:"text-gray-500 dark:text-gray-400"},"ID:",-1)),t("span",Gt,a(o.value.id),1)]),t("div",Jt,[e[20]||(e[20]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Date:",-1)),t("span",Kt,a(_(o.value.date)),1)]),t("div",Qt,[e[21]||(e[21]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Status:",-1)),t("span",Wt,[t("span",{class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",w(o.value.status)])},a(o.value.status),3)])]),t("div",Yt,[e[22]||(e[22]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Location:",-1)),t("span",Zt,a(o.value.locationId),1)])])]),t("div",te,[e[28]||(e[28]=t("h4",{class:"font-medium text-gray-700 dark:text-gray-300 mb-2"},"Transaction Summary",-1)),t("div",ee,[t("div",se,[e[24]||(e[24]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Total Transactions:",-1)),t("span",ae,a(o.value.totalTransactions),1)]),t("div",re,[e[25]||(e[25]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Total Amount:",-1)),t("span",oe,"$"+a(o.value.totalAmount.toFixed(2)),1)]),t("div",ne,[e[26]||(e[26]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Opened By:",-1)),t("span",de,a(o.value.openedBy),1)]),t("div",ie,[e[27]||(e[27]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Closed By:",-1)),t("span",le,a(o.value.closedBy||"—"),1)])])]),t("div",ce,[e[33]||(e[33]=t("h4",{class:"font-medium text-gray-700 dark:text-gray-300 mb-2"},"Reconciliation Status",-1)),t("div",ge,[t("div",ue,[e[29]||(e[29]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Expected Amount:",-1)),t("span",xe," $"+a(((v=o.value.differences)==null?void 0:v.expectedAmount.toFixed(2))||o.value.totalAmount.toFixed(2)),1)]),t("div",ye,[e[30]||(e[30]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Actual Amount:",-1)),t("span",pe," $"+a(((j=o.value.differences)==null?void 0:j.actualAmount.toFixed(2))||"—"),1)]),t("div",be,[e[31]||(e[31]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Variance:",-1)),t("span",{class:b(["font-medium",z(o.value)])}," $"+a((($=o.value.differences)==null?void 0:$.variance.toFixed(2))||"0.00"),3)]),t("div",ve,[e[32]||(e[32]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Reconciled By:",-1)),t("span",fe,a(o.value.reconciledBy||"—"),1)])])])]),t("div",me,[e[35]||(e[35]=t("h4",{class:"font-medium text-gray-700 dark:text-gray-300 mb-3"},"Payment Method Breakdown",-1)),t("div",ke,[t("table",he,[e[34]||(e[34]=t("thead",null,[t("tr",{class:"bg-gray-100 dark:bg-gray-600"},[t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Method"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Count"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Expected"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Actual"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Variance")])],-1)),t("tbody",_e,[(d(!0),n(T,null,R(o.value.paymentMethods,(r,f)=>(d(),n("tr",{key:f,class:"hover:bg-gray-100 dark:hover:bg-gray-600"},[t("td",we,a(r.paymentMethodName),1),t("td",Be,a(r.transactionCount),1),t("td",Ce,"$"+a(r.expectedAmount.toFixed(2)),1),t("td",je,"$"+a(r.actualAmount.toFixed(2)),1),t("td",{class:b(["px-4 py-2 whitespace-nowrap",r.variance===0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])}," $"+a(r.variance.toFixed(2)),3)]))),128))])])])]),o.value.differences&&o.value.differences.notes?(d(),n("div",$e,[e[36]||(e[36]=t("h4",{class:"font-medium text-gray-700 dark:text-gray-300 mb-2"},"Reconciliation Notes",-1)),t("div",Ae,[t("p",Te,a(o.value.differences.notes),1)])])):g("",!0),t("div",Re,[t("button",{onClick:e[3]||(e[3]=r=>u.value=!1),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}," Close "),o.value.status==="open"?(d(),n("button",{key:0,onClick:e[4]||(e[4]=r=>{B(o.value.id),u.value=!1}),class:"px-4 py-2 bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 text-white rounded-lg"}," Close Batch ")):g("",!0),o.value.status==="closed"?(d(),n("button",{key:1,onClick:e[5]||(e[5]=r=>{C(o.value.id),u.value=!1}),class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white rounded-lg"}," Reconcile ")):g("",!0)])])):g("",!0)])])):g("",!0)])}}});export{Ne as default};
