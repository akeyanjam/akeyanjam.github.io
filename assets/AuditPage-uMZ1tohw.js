import{c as $,d as B,m as x,i as h,a as k,o as _,f as s,w as a,u as t,_ as y,a0 as C,g as o,e as l,S as O,M as V,t as n,N as z,O as W,j as H,k as G}from"./index-Cq09uyUw.js";import{b as J,_ as p,a as v}from"./EntityHeader.vue_vue_type_script_setup_true_lang-DaY23PJ3.js";import{a as b,_ as S,b as K}from"./CardTitle.vue_vue_type_script_setup_true_lang-D4zeA_Ws.js";import{e as Q,_ as X,a as L,b as m,c as Y,d as c}from"./TableHeader.vue_vue_type_script_setup_true_lang-JG1VgffO.js";import{_ as g}from"./index-Dqndwl6j.js";import{_ as T,a as E,b as M,c as D,d as f}from"./SelectValue.vue_vue_type_script_setup_true_lang-C04wA-zB.js";import{_ as R}from"./Switch.vue_vue_type_script_setup_true_lang-BpNhl_fW.js";import{_ as ee,g as te,h as se,j as ae,k as le}from"./SheetTitle.vue_vue_type_script_setup_true_lang-DyyP2rqd.js";import"./VisuallyHidden-CoIEhRBi.js";import"./VisuallyHiddenInput-B5nBr247.js";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=$("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=$("radio",[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=$("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),ne={class:"space-y-8"},de={class:"grid gap-4 lg:grid-cols-4"},ie={class:"space-y-2"},fe={class:"relative"},me={class:"space-y-2"},ce={class:"space-y-2"},pe={class:"space-y-2"},ve={class:"flex flex-wrap items-center gap-3 text-xs text-muted-foreground"},xe={class:"flex items-center justify-between text-xs text-muted-foreground"},_e={class:"flex items-center gap-2"},ye={class:"text-sm font-medium text-foreground"},ge={class:"text-xs text-muted-foreground"},we={class:"text-sm font-medium text-foreground"},ke={class:"text-xs text-muted-foreground"},be={key:0,class:"mt-6 space-y-4"},Se={class:"text-foreground font-medium"},$e={class:"text-foreground font-medium"},Ie={class:"text-foreground font-medium"},qe={class:"text-foreground font-medium"},Ae={class:"rounded-md bg-muted p-3 text-xs overflow-x-auto"},Ce={class:"text-foreground font-medium"},Ve={class:"text-foreground font-medium"},Le={class:"text-foreground font-medium"},Te={class:"text-foreground font-medium"},Oe=B({__name:"AuditPage",setup(Ee){const u=x({query:"",actor:"",action:"all",range:"30d",showSystem:!1,showSensitive:!1}),U=x([{id:"evt-5073",timestamp:"2025-09-18T12:45:12Z",actor:"maya.patel@partner.com",ip:"192.168.140.22",action:"update",resource:"disputes.settings",success:!0,diff:`{
  "webhook": {
    "retryPolicy": "exponential"
  }
}`,userAgent:"Chrome 127 on macOS",requestId:"req-1a4f5",traceId:"trace-8841",latency:"412 ms",system:!1,sensitive:!1},{id:"evt-5070",timestamp:"2025-09-18T11:12:40Z",actor:"system",ip:"127.0.0.1",action:"access",resource:"sandbox.reset",success:!0,diff:`{
  "status": "completed"
}`,userAgent:"Internal Scheduler",requestId:"req-9f11a",traceId:"trace-8810",latency:"1.2 s",system:!0,sensitive:!1},{id:"evt-5068",timestamp:"2025-09-18T09:58:02Z",actor:"alex.rivera@partner.com",ip:"10.24.41.8",action:"create",resource:"api-key.prod",success:!0,diff:`{
  "keyId": "ak-prod-8831",
  "scopes": ["payments.read"]
}`,userAgent:"Firefox 128 on Windows",requestId:"req-3ba21",traceId:"trace-8766",latency:"298 ms",system:!1,sensitive:!0},{id:"evt-5060",timestamp:"2025-09-17T21:05:47Z",actor:"priya.rivera@partner.com",ip:"192.168.22.14",action:"delete",resource:"reports.scheduled-settlement",success:!0,diff:`{
  "scheduleId": "settlement-daily"
}`,userAgent:"Edge 126 on Windows",requestId:"req-2893c",traceId:"trace-8520",latency:"365 ms",system:!1,sensitive:!1},{id:"evt-5055",timestamp:"2025-09-17T18:14:20Z",actor:"system",ip:"127.0.0.1",action:"update",resource:"security.passkey-rotation",success:!0,diff:`{
  "status": "initiated"
}`,userAgent:"Internal Scheduler",requestId:"req-1749b",traceId:"trace-8442",latency:"980 ms",system:!0,sensitive:!0}]),I=h(()=>U.value.filter(d=>{if(!u.value.showSystem&&d.system||!u.value.showSensitive&&d.sensitive||u.value.actor&&!d.actor.toLowerCase().includes(u.value.actor.toLowerCase())||u.value.action!=="all"&&d.action!==u.value.action)return!1;const e=u.value.query.trim().toLowerCase();return!(e&&!(d.actor.toLowerCase().includes(e)||d.resource.toLowerCase().includes(e)||d.diff.toLowerCase().includes(e)))})),w=x(!1),i=x(null);function j(d){i.value=d,w.value=!0}function F(){u.value={query:"",actor:"",action:"all",range:"30d",showSystem:!1,showSensitive:!1}}function N(d){switch(d){case"update":return"secondary";case"create":return"default";case"delete":return"destructive";default:return"outline"}}function q(d){return new Intl.DateTimeFormat("en",{dateStyle:"medium",timeStyle:"short"}).format(new Date(d))}function P(d){const e=new Date(d),r=new Date,A=e.getTime()-r.getTime(),Z=Math.round(A/(1e3*60*60));return new Intl.RelativeTimeFormat("en",{numeric:"auto"}).format(Z,"hour")}return(d,e)=>(_(),k("div",ne,[s(J,{title:"Audit Log",description:"Trace user actions and system changes across the platform"},{actions:a(()=>[s(t(y),{variant:"outline",onClick:e[0]||(e[0]=r=>t(C).success("Archive queued",{description:"Export for the last 30 days will be delivered to S3."}))},{default:a(()=>[s(t(re),{class:"mr-2 h-4 w-4"}),e[9]||(e[9]=o(" Export Archive ",-1))]),_:1}),s(t(y),{onClick:e[1]||(e[1]=r=>t(C).info("Streaming enabled",{description:"Streamed events are now being forwarded to your SIEM."}))},{default:a(()=>[s(t(oe),{class:"mr-2 h-4 w-4"}),e[10]||(e[10]=o(" Enable Streaming ",-1))]),_:1})]),_:1}),s(t(p),{class:"card-compact"},{default:a(()=>[s(t(v),{class:"space-y-4"},{default:a(()=>[l("div",de,[l("div",ie,[e[11]||(e[11]=l("label",{class:"text-xs font-medium text-muted-foreground uppercase"},"Search",-1)),l("div",fe,[s(t(O),{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s(t(V),{class:"pl-9",modelValue:u.value.query,"onUpdate:modelValue":e[2]||(e[2]=r=>u.value.query=r),placeholder:"Search actor, resource, payload"},null,8,["modelValue"])])]),l("div",me,[e[12]||(e[12]=l("label",{class:"text-xs font-medium text-muted-foreground uppercase"},"Actor",-1)),s(t(V),{modelValue:u.value.actor,"onUpdate:modelValue":e[3]||(e[3]=r=>u.value.actor=r),placeholder:"maya.patel@partner.com"},null,8,["modelValue"])]),l("div",ce,[e[18]||(e[18]=l("label",{class:"text-xs font-medium text-muted-foreground uppercase"},"Action",-1)),s(t(T),{modelValue:u.value.action,"onUpdate:modelValue":e[4]||(e[4]=r=>u.value.action=r)},{default:a(()=>[s(t(E),null,{default:a(()=>[s(t(M),{placeholder:"All actions"})]),_:1}),s(t(D),null,{default:a(()=>[s(t(f),{value:"all"},{default:a(()=>[...e[13]||(e[13]=[o("All",-1)])]),_:1}),s(t(f),{value:"update"},{default:a(()=>[...e[14]||(e[14]=[o("Update",-1)])]),_:1}),s(t(f),{value:"create"},{default:a(()=>[...e[15]||(e[15]=[o("Create",-1)])]),_:1}),s(t(f),{value:"delete"},{default:a(()=>[...e[16]||(e[16]=[o("Delete",-1)])]),_:1}),s(t(f),{value:"access"},{default:a(()=>[...e[17]||(e[17]=[o("Access",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l("div",pe,[e[22]||(e[22]=l("label",{class:"text-xs font-medium text-muted-foreground uppercase"},"Date range",-1)),s(t(T),{modelValue:u.value.range,"onUpdate:modelValue":e[5]||(e[5]=r=>u.value.range=r)},{default:a(()=>[s(t(E),null,{default:a(()=>[s(t(M),{placeholder:"Last 7 days"})]),_:1}),s(t(D),null,{default:a(()=>[s(t(f),{value:"7d"},{default:a(()=>[...e[19]||(e[19]=[o("Last 7 days",-1)])]),_:1}),s(t(f),{value:"30d"},{default:a(()=>[...e[20]||(e[20]=[o("Last 30 days",-1)])]),_:1}),s(t(f),{value:"90d"},{default:a(()=>[...e[21]||(e[21]=[o("Last 90 days",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),l("div",ve,[s(t(R),{checked:u.value.showSystem,"onUpdate:checked":e[6]||(e[6]=r=>u.value.showSystem=r)},null,8,["checked"]),e[24]||(e[24]=l("span",null,"Show system generated events",-1)),s(t(R),{checked:u.value.showSensitive,"onUpdate:checked":e[7]||(e[7]=r=>u.value.showSensitive=r)},null,8,["checked"]),e[25]||(e[25]=l("span",null,"Include sensitive resources (requires admin)",-1)),s(t(y),{variant:"ghost",size:"sm",onClick:F},{default:a(()=>[s(t(ue),{class:"mr-2 h-4 w-4"}),e[23]||(e[23]=o(" Reset Filters ",-1))]),_:1})])]),_:1})]),_:1}),s(t(p),{class:"card-compact"},{default:a(()=>[s(t(v),{class:"space-y-3"},{default:a(()=>[l("div",xe,[l("span",null,"Showing "+n(I.value.length)+" events",1),l("div",_e,[s(t(g),{variant:"outline"},{default:a(()=>[...e[26]||(e[26]=[o("Streaming: Enabled",-1)])]),_:1}),s(t(g),{variant:"outline"},{default:a(()=>[...e[27]||(e[27]=[o("Retention: 180 days",-1)])]),_:1})])]),s(t(Q),{class:"table-compact","container-class":"px-4"},{default:a(()=>[s(t(X),null,{default:a(()=>[s(t(L),null,{default:a(()=>[s(t(m),null,{default:a(()=>[...e[28]||(e[28]=[o("Timestamp",-1)])]),_:1}),s(t(m),null,{default:a(()=>[...e[29]||(e[29]=[o("Actor",-1)])]),_:1}),s(t(m),null,{default:a(()=>[...e[30]||(e[30]=[o("Action",-1)])]),_:1}),s(t(m),null,{default:a(()=>[...e[31]||(e[31]=[o("Resource",-1)])]),_:1}),s(t(m),null,{default:a(()=>[...e[32]||(e[32]=[o("Result",-1)])]),_:1}),s(t(m),{class:"text-right"},{default:a(()=>[...e[33]||(e[33]=[o("Details",-1)])]),_:1})]),_:1})]),_:1}),s(t(Y),null,{default:a(()=>[(_(!0),k(z,null,W(I.value,r=>(_(),H(t(L),{key:r.id,class:"cursor-pointer transition hover:bg-accent/5",onClick:A=>j(r)},{default:a(()=>[s(t(c),null,{default:a(()=>[l("div",ye,n(q(r.timestamp)),1),l("div",ge,n(P(r.timestamp)),1)]),_:2},1024),s(t(c),null,{default:a(()=>[l("div",we,n(r.actor),1),l("div",ke,"IP "+n(r.ip),1)]),_:2},1024),s(t(c),{class:"text-sm"},{default:a(()=>[s(t(g),{variant:N(r.action),class:"uppercase"},{default:a(()=>[o(n(r.action),1)]),_:2},1032,["variant"])]),_:2},1024),s(t(c),{class:"text-sm"},{default:a(()=>[o(n(r.resource),1)]),_:2},1024),s(t(c),{class:"text-sm"},{default:a(()=>[s(t(g),{variant:r.success?"secondary":"destructive"},{default:a(()=>[o(n(r.success?"Success":"Error"),1)]),_:2},1032,["variant"])]),_:2},1024),s(t(c),{class:"text-right text-xs"},{default:a(()=>[s(t(y),{variant:"link",size:"sm",class:"px-0"},{default:a(()=>[...e[34]||(e[34]=[o("Inspect",-1)])]),_:1})]),_:1})]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),s(t(ee),{open:w.value,"onUpdate:open":e[8]||(e[8]=r=>w.value=r)},{default:a(()=>[s(t(te),{class:"sm:max-w-2xl"},{default:a(()=>[s(t(se),null,{default:a(()=>[s(t(ae),null,{default:a(()=>[...e[35]||(e[35]=[o("Event detail",-1)])]),_:1}),s(t(le),null,{default:a(()=>[o(n(i.value?.actor)+" â€¢ "+n(i.value?q(i.value.timestamp):""),1)]),_:1})]),_:1}),i.value?(_(),k("div",be,[s(t(p),{class:"card-compact"},{default:a(()=>[s(t(b),{class:"pb-2"},{default:a(()=>[s(t(S),{class:"text-base"},{default:a(()=>[...e[36]||(e[36]=[o("Summary",-1)])]),_:1})]),_:1}),s(t(v),{class:"grid gap-3 md:grid-cols-2 text-sm text-muted-foreground"},{default:a(()=>[l("div",null,[e[37]||(e[37]=l("p",{class:"text-xs uppercase"},"Action",-1)),l("p",Se,n(i.value.action),1)]),l("div",null,[e[38]||(e[38]=l("p",{class:"text-xs uppercase"},"Resource",-1)),l("p",$e,n(i.value.resource),1)]),l("div",null,[e[39]||(e[39]=l("p",{class:"text-xs uppercase"},"Result",-1)),l("p",Ie,n(i.value.success?"Success":"Error"),1)]),l("div",null,[e[40]||(e[40]=l("p",{class:"text-xs uppercase"},"Actor IP",-1)),l("p",qe,n(i.value.ip),1)])]),_:1})]),_:1}),s(t(p),{class:"card-compact"},{default:a(()=>[s(t(b),{class:"pb-2"},{default:a(()=>[s(t(S),{class:"text-base"},{default:a(()=>[...e[41]||(e[41]=[o("Payload Diff",-1)])]),_:1}),s(t(K),null,{default:a(()=>[...e[42]||(e[42]=[o("Compare before and after values captured by the audit service.",-1)])]),_:1})]),_:1}),s(t(v),null,{default:a(()=>[l("pre",Ae,n(i.value.diff),1)]),_:1})]),_:1}),s(t(p),{class:"card-compact"},{default:a(()=>[s(t(b),{class:"pb-2"},{default:a(()=>[s(t(S),{class:"text-base"},{default:a(()=>[...e[43]||(e[43]=[o("Metadata",-1)])]),_:1})]),_:1}),s(t(v),{class:"grid gap-3 md:grid-cols-2 text-xs text-muted-foreground"},{default:a(()=>[l("div",null,[e[44]||(e[44]=l("p",{class:"uppercase"},"User Agent",-1)),l("p",Ce,n(i.value.userAgent),1)]),l("div",null,[e[45]||(e[45]=l("p",{class:"uppercase"},"Request ID",-1)),l("p",Ve,n(i.value.requestId),1)]),l("div",null,[e[46]||(e[46]=l("p",{class:"uppercase"},"Trace ID",-1)),l("p",Le,n(i.value.traceId),1)]),l("div",null,[e[47]||(e[47]=l("p",{class:"uppercase"},"Latency",-1)),l("p",Te,n(i.value.latency),1)])]),_:1})]),_:1})])):G("",!0)]),_:1})]),_:1},8,["open"])]))}});export{Oe as default};
