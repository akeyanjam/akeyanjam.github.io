import{d as q,r as i,o as Y,c as f,b as l,e,j as k,y as n,z as c,f as h,u,A as J,B as P,i as b,t as o,F as Q,m as R,X as U,q as L,G as H,h as d,x as K}from"./index-CBlyhhB_.js";import{u as W}from"./salesStore--0mzQDZj.js";import{C as Z}from"./chevron-down-CAD7_O72.js";import{P as ee}from"./plus-DRTQa6gY.js";const te={class:"discounts-container dark:bg-gray-900"},re={class:"mb-6 flex justify-between items-center"},ae={class:"flex space-x-2"},se={class:"relative"},oe={class:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},le={class:"relative"},de={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden"},ne={key:0,class:"flex justify-center items-center h-64"},ie={key:1,class:"text-red-500 dark:text-red-400 text-center py-8"},ue={key:2,class:"text-center py-8 text-gray-500 dark:text-gray-400"},ge={key:3},ce={class:"overflow-x-auto"},pe={class:"w-full border-collapse"},ye={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},be={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},xe={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ve={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},me={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},fe={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ke={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},he={key:0,class:"text-gray-400 dark:text-gray-500"},we={class:"px-6 py-4 whitespace-nowrap"},De={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},_e=["onClick"],Ce=["onClick"],Ve={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-between items-center border-t border-gray-200 dark:border-gray-600"},Se={class:"text-sm text-gray-500 dark:text-gray-400"},$e={class:"font-medium"},Pe={class:"font-medium"},Ue={class:"font-medium"},Le={class:"flex space-x-2"},Ne=["disabled"],Te=["disabled"],Oe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},je={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-3xl w-full mx-4"},Ae={class:"flex justify-between items-center mb-4"},Fe={class:"text-xl font-bold dark:text-white"},Me={class:"space-y-4"},Ee={class:"grid grid-cols-2 gap-4"},Be={class:"relative"},Ie={key:0,class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400"},ze={key:1,class:"absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400"},Ge=["placeholder"],Xe={class:"grid grid-cols-2 gap-4"},qe={class:"grid grid-cols-2 gap-4"},Ye={class:"relative"},Je={class:"flex items-center"},Qe={class:"flex justify-end space-x-3 mt-6"},Re={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},He={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-md w-full mx-4"},Ke={class:"flex justify-between items-center mb-4"},We={class:"space-y-4"},Ze={class:"flex justify-end space-x-3 mt-6"},lt=q({__name:"DiscountsView",setup(et){K();const x=W(),{isLoading:N,error:S,fetchDiscounts:T}=x,g=i(1),v=i(10),w=i(""),D=i("all"),p=i(!1),m=i(!1),_=i(null),C=i(null),s=i({name:"",type:"percentage",value:0,startDate:"",endDate:"",active:!0,applicableProducts:[],applicableCategories:[],minimumOrderValue:0,usageLimit:0});Y(async()=>{try{await T()}catch(a){console.error("Error fetching discounts:",a)}});const y=f(()=>{if(!x.discounts||x.discounts.length===0)return[];let a=[...x.discounts];if(D.value!=="all"){const t=D.value==="active";a=a.filter(r=>r.active===t)}if(w.value){const t=w.value.toLowerCase();a=a.filter(r=>r.name.toLowerCase().includes(t))}return a.sort((t,r)=>new Date(r.startDate).getTime()-new Date(t.startDate).getTime())}),O=f(()=>{const a=(g.value-1)*v.value,t=a+v.value;return y.value.slice(a,t)}),j=f(()=>Math.ceil(y.value.length/v.value)),A=f(()=>(g.value-1)*v.value+1),F=f(()=>{const a=g.value*v.value;return a>y.value.length?y.value.length:a}),$=a=>{const t=new Date(a);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t)},M=a=>{switch(a){case"percentage":return"Percentage";case"fixed":return"Fixed Amount";case"buy_x_get_y":return"Buy X Get Y";default:return a}},E=a=>{switch(a.type){case"percentage":return`${a.value}%`;case"fixed":return`$${a.value.toFixed(2)}`;case"buy_x_get_y":return`${a.value}% off`;default:return a.value.toString()}},B=()=>{s.value={name:"",type:"percentage",value:0,startDate:"",endDate:"",active:!0,applicableProducts:[],applicableCategories:[],minimumOrderValue:0,usageLimit:0},_.value=null,p.value=!0},I=a=>{const t=x.discounts.find(r=>r.id===a);if(t){_.value=t;const r=V=>new Date(V).toISOString().split("T")[0];s.value={name:t.name,type:t.type,value:t.value,startDate:r(t.startDate),endDate:r(t.endDate),active:t.active,applicableProducts:t.applicableProducts||[],applicableCategories:t.applicableCategories||[],minimumOrderValue:t.minimumOrderValue||0,usageLimit:t.usageLimit||0},p.value=!0}},z=()=>{console.log(`Saving discount: ${JSON.stringify(s.value)}`),p.value=!1},G=a=>{C.value=a,m.value=!0},X=()=>{C.value&&(console.log(`Deleting discount with ID: ${C.value}`),m.value=!1,C.value=null)};return(a,t)=>(d(),l("div",te,[e("header",re,[t[18]||(t[18]=e("div",null,[e("h1",{class:"text-3xl font-bold dark:text-white"},"Discounts & Promotions"),e("p",{class:"text-gray-500 dark:text-gray-400 mt-2"},"Manage promotions and special offers")],-1)),e("div",ae,[e("div",se,[n(e("input",{type:"text",placeholder:"Search discounts...",class:"px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[0]||(t[0]=r=>w.value=r)},null,512),[[c,w.value]]),e("button",oe,[h(u(J),{class:"w-5 h-5"})])]),e("div",le,[n(e("select",{class:"appearance-none px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8","onUpdate:modelValue":t[1]||(t[1]=r=>D.value=r)},t[16]||(t[16]=[e("option",{value:"all"},"All Status",-1),e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)]),512),[[P,D.value]]),h(u(Z),{class:"absolute right-3 top-3 w-4 h-4 text-gray-400 pointer-events-none"})]),e("button",{class:"px-4 py-2 bg-purple-600 hover:bg-purple-700 dark:bg-purple-700 dark:hover:bg-purple-800 text-white font-medium rounded-lg transition-colors",onClick:B},[h(u(ee),{class:"w-5 h-5 mr-1 inline-block"}),t[17]||(t[17]=b(" New Discount "))])])]),e("section",de,[u(N)?(d(),l("div",ne,t[19]||(t[19]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-100"},null,-1)]))):u(S)?(d(),l("div",ie,o(u(S)),1)):y.value.length===0?(d(),l("div",ue," No discounts found. ")):(d(),l("div",ge,[e("div",ce,[e("table",pe,[t[20]||(t[20]=e("thead",null,[e("tr",{class:"bg-gray-50 dark:bg-gray-700 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},[e("th",{class:"px-6 py-3"},"Name"),e("th",{class:"px-6 py-3"},"Type"),e("th",{class:"px-6 py-3"},"Value"),e("th",{class:"px-6 py-3"},"Start Date"),e("th",{class:"px-6 py-3"},"End Date"),e("th",{class:"px-6 py-3"},"Usage"),e("th",{class:"px-6 py-3"},"Status"),e("th",{class:"px-6 py-3"},"Actions")])],-1)),e("tbody",ye,[(d(!0),l(Q,null,R(O.value,r=>(d(),l("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",be,o(r.name),1),e("td",xe,o(M(r.type)),1),e("td",ve,o(E(r)),1),e("td",me,o($(r.startDate)),1),e("td",fe,o($(r.endDate)),1),e("td",ke,[b(o(r.usageCount)+" ",1),r.usageLimit?(d(),l("span",he," / "+o(r.usageLimit),1)):k("",!0)]),e("td",we,[e("span",{class:L(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",r.active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"])},o(r.active?"Active":"Inactive"),3)]),e("td",De,[e("button",{class:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3",onClick:V=>I(r.id)}," Edit ",8,_e),e("button",{class:"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300",onClick:V=>G(r.id)}," Delete ",8,Ce)])]))),128))])])]),e("div",Ve,[e("div",Se,[t[21]||(t[21]=b(" Showing ")),e("span",$e,o(A.value),1),t[22]||(t[22]=b(" to ")),e("span",Pe,o(F.value),1),t[23]||(t[23]=b(" of ")),e("span",Ue,o(y.value.length),1),t[24]||(t[24]=b(" discounts "))]),e("div",Le,[e("button",{class:"px-3 py-1 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:g.value===1,onClick:t[2]||(t[2]=r=>g.value--)}," Previous ",8,Ne),e("button",{class:"px-3 py-1 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:g.value===j.value,onClick:t[3]||(t[3]=r=>g.value++)}," Next ",8,Te)])])]))]),p.value?(d(),l("div",Oe,[e("div",je,[e("div",Ae,[e("h3",Fe,o(_.value?"Edit Discount":"Create New Discount"),1),e("button",{onClick:t[4]||(t[4]=r=>p.value=!1),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[h(u(U),{class:"w-5 h-5"})])]),e("div",Me,[e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Discount Name ",-1)),n(e("input",{type:"text",placeholder:"Enter discount name",class:"w-full px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[5]||(t[5]=r=>s.value.name=r)},null,512),[[c,s.value.name]])]),e("div",Ee,[e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Discount Type ",-1)),n(e("select",{class:"w-full px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[6]||(t[6]=r=>s.value.type=r)},t[26]||(t[26]=[e("option",{value:"percentage"},"Percentage",-1),e("option",{value:"fixed"},"Fixed Amount",-1),e("option",{value:"buy_x_get_y"},"Buy X Get Y",-1)]),512),[[P,s.value.type]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Value ",-1)),e("div",Be,[s.value.type==="percentage"?(d(),l("span",Ie," % ")):k("",!0),s.value.type==="fixed"?(d(),l("span",ze," $ ")):k("",!0),n(e("input",{type:"number",placeholder:s.value.type==="percentage"?"e.g. 10 (%)":s.value.type==="fixed"?"e.g. 5.99 ($)":"e.g. 100 (%)",class:L(["w-full px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent",{"pl-8":s.value.type==="fixed"}]),"onUpdate:modelValue":t[7]||(t[7]=r=>s.value.value=r)},null,10,Ge),[[c,s.value.value,void 0,{number:!0}]])])])]),e("div",Xe,[e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Start Date ",-1)),n(e("input",{type:"date",class:"w-full px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[8]||(t[8]=r=>s.value.startDate=r)},null,512),[[c,s.value.startDate]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," End Date ",-1)),n(e("input",{type:"date",class:"w-full px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[9]||(t[9]=r=>s.value.endDate=r)},null,512),[[c,s.value.endDate]])])]),e("div",qe,[e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Minimum Order Value (Optional) ",-1)),e("div",Ye,[t[31]||(t[31]=e("span",{class:"absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400"},"$",-1)),n(e("input",{type:"number",placeholder:"e.g. 50",class:"w-full pl-8 px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[10]||(t[10]=r=>s.value.minimumOrderValue=r)},null,512),[[c,s.value.minimumOrderValue,void 0,{number:!0}]])])]),e("div",null,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Usage Limit (Optional) ",-1)),n(e("input",{type:"number",placeholder:"e.g. 100",class:"w-full px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":t[11]||(t[11]=r=>s.value.usageLimit=r)},null,512),[[c,s.value.usageLimit,void 0,{number:!0}]])])]),e("div",null,[e("label",Je,[n(e("input",{type:"checkbox",class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50 dark:border-gray-600 dark:bg-gray-700","onUpdate:modelValue":t[12]||(t[12]=r=>s.value.active=r)},null,512),[[H,s.value.active]]),t[34]||(t[34]=e("span",{class:"ml-2 text-gray-700 dark:text-gray-300"},"Active",-1))])]),e("div",Qe,[e("button",{class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300",onClick:t[13]||(t[13]=r=>p.value=!1)}," Cancel "),e("button",{class:"px-4 py-2 rounded-lg bg-purple-600 hover:bg-purple-700 dark:bg-purple-700 dark:hover:bg-purple-800 text-white",onClick:z},o(_.value?"Update Discount":"Create Discount"),1)])])])])):k("",!0),m.value?(d(),l("div",Re,[e("div",He,[e("div",Ke,[t[35]||(t[35]=e("h3",{class:"text-xl font-bold dark:text-white"},"Confirm Delete",-1)),e("button",{onClick:t[14]||(t[14]=r=>m.value=!1),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[h(u(U),{class:"w-5 h-5"})])]),e("div",We,[t[36]||(t[36]=e("p",{class:"text-gray-700 dark:text-gray-300"}," Are you sure you want to delete this discount? This action cannot be undone. ",-1)),e("div",Ze,[e("button",{class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300",onClick:t[15]||(t[15]=r=>m.value=!1)}," Cancel "),e("button",{class:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 text-white",onClick:X}," Delete ")])])])])):k("",!0)]))}});export{lt as default};
