import{d as De,q as y,k as f,z as P,a as c,o as i,f as t,e as u,l as U,m as N,w as a,u as e,O as v,Q as g,t as o,i as d,_ as w,S as Ce,h as Se,D as Ve,a1 as j}from"./index-576eSvVJ.js";import{b as Ae,_,a as x}from"./EntityHeader.vue_vue_type_script_setup_true_lang-v24bUCRs.js";import{a as b,b as W,_ as h}from"./CardTitle.vue_vue_type_script_setup_true_lang-Bs-VGCOC.js";import{_ as te,a as se,b as ae,c as le,d as I}from"./SelectValue.vue_vue_type_script_setup_true_lang-C_UccSTK.js";import{_ as Re,a as ne,b as S,c as Te,d as V,e as Fe}from"./TableHeader.vue_vue_type_script_setup_true_lang-DjITxISQ.js";import{u as Ue,_ as qe,a as p,b as oe,c as Ee,d as Le}from"./useApi-o4XBSgBc.js";import{_ as Ne,a as je,b as Ie}from"./index-C_gcTRnI.js";import{_ as ze,g as Me,h as Oe,j as Be,k as Pe}from"./SheetTitle.vue_vue_type_script_setup_true_lang-C8C5jjdj.js";import{_ as We}from"./Textarea.vue_vue_type_script_setup_true_lang-DVgW7Wsi.js";import{_ as q}from"./index-D3I8kFeh.js";import{_ as Qe,a as ue}from"./ToggleGroupItem.vue_vue_type_script_setup_true_lang-tLrpsY3S.js";import{D as He}from"./download-CvPqyPHV.js";import{L as Ge}from"./list-filter-Czy2UDzP.js";import{F as Je}from"./file-up-D7VHUPfa.js";import"./VisuallyHidden-BWEYnMiB.js";import"./RovingFocusItem-D-8-qXdz.js";import"./VisuallyHiddenInput-EiEe8QJF.js";const Ke={class:"space-y-6"},Xe={class:"flex flex-wrap items-center gap-4"},Ye={class:"relative flex-1 min-w-64"},Ze={class:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4"},et={key:0,class:"p-4 space-y-4"},tt={class:"flex items-center gap-3"},st={class:"space-y-2"},at={class:"font-medium"},lt={class:"text-xs text-muted-foreground flex items-center gap-2"},nt={class:"font-medium"},ot={class:"text-xs text-muted-foreground"},ut={class:"font-medium"},dt={class:"text-xs text-muted-foreground"},rt={class:"font-medium"},it={class:"text-xs text-muted-foreground"},ct={key:1,class:"py-16"},mt={key:1,class:"flex items-center justify-between"},ft={class:"text-sm text-muted-foreground"},vt={key:0,class:"flex h-full flex-col"},_t={class:"text-xs text-muted-foreground"},pt={class:"text-xs text-muted-foreground"},xt={class:"mt-6 space-y-6 overflow-y-auto pr-2"},gt={class:"text-sm font-medium"},yt={class:"text-xs text-muted-foreground"},wt={class:"text-sm font-medium"},bt={class:"text-sm font-medium"},ht={class:"text-xs text-muted-foreground"},kt={class:"text-sm font-medium"},$t={class:"text-sm font-medium"},Dt={class:"text-xs text-muted-foreground"},Ct={class:"text-sm text-muted-foreground mt-1"},St={class:"text-sm font-medium"},Vt={key:0,class:"text-xs text-muted-foreground"},At={class:"flex justify-end"},Rt={key:0,class:"space-y-3"},Tt={class:"text-sm font-medium"},Ft={class:"text-xs text-muted-foreground"},Ut={key:1,class:"text-sm text-muted-foreground"},qt={class:"flex justify-end"},Et={class:"flex justify-end gap-2"},E=10,es=De({__name:"DisputesPage",setup(Lt){const de=["Inquiry","Chargeback","Pre-Arb"],k=y("all"),$=y("all"),D=y("all"),A=y(""),C=y(1),L=y(!1),r=y(null),R=y(""),{data:re,loading:Q,error:H}=Ue(()=>Le.disputes.list()),z=f(()=>re.value??[]),ie=f(()=>{const n=new Set;return z.value.forEach(s=>n.add(s.reason)),Array.from(n).sort()}),ce=f(()=>{const n=new Set;return z.value.forEach(s=>n.add(s.merchant.name)),Array.from(n).sort()}),T=f(()=>{const n=A.value.trim().toLowerCase();return z.value.filter(s=>{const l=n?s.id.toLowerCase().includes(n)||s.merchant.name.toLowerCase().includes(n)||s.merchant.dba.toLowerCase().includes(n)||s.reason.toLowerCase().includes(n)||s.assignedTo.toLowerCase().includes(n):!0,m=k.value==="all"||s.stage===k.value,B=$.value==="all"||s.reason===$.value,ee=D.value==="all"||s.merchant.name===D.value;return l&&m&&B&&ee})}),F=f(()=>T.value.length),G=f(()=>{const n=(C.value-1)*E;return T.value.slice(n,n+E)}),me=f(()=>F.value?(C.value-1)*E+1:0),fe=f(()=>Math.min(C.value*E,F.value)),ve=f(()=>T.value.filter(n=>!["won","lost"].includes(n.status)).length),_e=f(()=>T.value.filter(n=>{if(["won","lost"].includes(n.status))return!1;const s=new Date(n.deadline).getTime(),l=Date.now(),m=(s-l)/(1e3*60*60*24);return m>=0&&m<=3}).length),pe=f(()=>{const n=T.value.filter(m=>["won","lost"].includes(m.status));return n.length===0?"â€”":`${(n.filter(m=>m.status==="won").length/n.length*100).toFixed(1)}%`});P([k,$,D,A],()=>{C.value=1}),P(r,n=>{R.value=n?.notes??""}),P(L,n=>{n||(r.value=null,R.value="")});function J(n,s){return new Intl.NumberFormat("en-US",{style:"currency",currency:s}).format(n)}function M(n){return new Intl.DateTimeFormat("en",{dateStyle:"medium"}).format(new Date(n))}function O(n){return new Intl.DateTimeFormat("en",{dateStyle:"medium",timeStyle:"short"}).format(new Date(n))}function K(n){const s=new Date(n),l=new Date,m=s.getTime()-l.getTime(),B=Math.round(m/(1e3*60*60*24));return new Intl.RelativeTimeFormat("en",{numeric:"auto"}).format(B,"day")}function X(n){switch(n){case"won":return"success";case"lost":return"danger";case"awaiting-evidence":return"warning";case"evidence-submitted":return"info";case"hold":return"danger";default:return"warning"}}function Y(n){switch(n){case"open":return"Open";case"awaiting-evidence":return"Awaiting Evidence";case"evidence-submitted":return"Evidence Submitted";case"hold":return"On Hold";case"won":return"Won";case"lost":return"Lost";default:return n}}function xe(n){switch(n){case"uploaded":return"secondary";case"requested":return"outline";case"missing":return"destructive";default:return"outline"}}function ge(n){switch(n){case"uploaded":return"Uploaded";case"requested":return"Requested";case"missing":return"Missing";default:return n}}function Z(){A.value="",k.value="all",$.value="all",D.value="all"}function ye(n){r.value=n,L.value=!0}function we(){j.success("Export started",{description:"Preparing your dispute export in the background."})}function be(){j.info("Document request sent",{description:"The merchant will be notified of the requested document."})}function he(){j.success("Upload queued",{description:"Evidence upload flow would open in production."})}function ke(){j.success("Note saved",{description:"Internal note updated for this dispute."})}function $e(){R.value=r.value?.notes??""}return(n,s)=>(i(),c("div",Ke,[t(Ae,{title:"Disputes",description:"Chargeback tracking and evidence management"},{actions:a(()=>[t(e(Qe),{modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=l=>k.value=l),type:"single",class:"bg-muted/40 rounded-md border border-border/60"},{default:a(()=>[t(e(ue),{value:"all",class:"px-3 py-1.5 text-xs font-medium uppercase tracking-wide"},{default:a(()=>[...s[7]||(s[7]=[d(" All Stages ",-1)])]),_:1}),(i(),c(v,null,g(de,l=>t(e(ue),{key:l,value:l,class:"px-3 py-1.5 text-xs font-medium uppercase tracking-wide"},{default:a(()=>[d(o(l),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),t(e(te),{modelValue:$.value,"onUpdate:modelValue":s[1]||(s[1]=l=>$.value=l)},{default:a(()=>[t(e(se),{class:"w-48"},{default:a(()=>[t(e(ae),{placeholder:"All reasons"})]),_:1}),t(e(le),null,{default:a(()=>[t(e(I),{value:"all"},{default:a(()=>[...s[8]||(s[8]=[d("All Reasons",-1)])]),_:1}),(i(!0),c(v,null,g(ie.value,l=>(i(),U(e(I),{key:l,value:l},{default:a(()=>[d(o(l),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),t(e(te),{modelValue:D.value,"onUpdate:modelValue":s[2]||(s[2]=l=>D.value=l)},{default:a(()=>[t(e(se),{class:"w-48"},{default:a(()=>[t(e(ae),{placeholder:"All merchants"})]),_:1}),t(e(le),null,{default:a(()=>[t(e(I),{value:"all"},{default:a(()=>[...s[9]||(s[9]=[d("All Merchants",-1)])]),_:1}),(i(!0),c(v,null,g(ce.value,l=>(i(),U(e(I),{key:l,value:l},{default:a(()=>[d(o(l),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),t(e(w),{variant:"outline",onClick:we},{default:a(()=>[t(e(He),{class:"mr-2 h-4 w-4"}),s[10]||(s[10]=d(" Export CSV ",-1))]),_:1})]),_:1}),t(e(_),{class:"card-compact"},{default:a(()=>[t(e(x),null,{default:a(()=>[u("div",Xe,[u("div",Ye,[t(e(Ce),{class:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground h-4 w-4"}),t(e(Se),{modelValue:A.value,"onUpdate:modelValue":s[3]||(s[3]=l=>A.value=l),type:"search",placeholder:"Search by case ID, merchant, reason, or assigned user",class:"pl-9"},null,8,["modelValue"])]),t(e(w),{variant:"ghost",size:"sm",onClick:Z},{default:a(()=>[t(e(Ge),{class:"mr-2 h-4 w-4"}),s[11]||(s[11]=d(" Reset filters ",-1))]),_:1})])]),_:1})]),_:1}),u("div",Ze,[e(Q)?(i(),c(v,{key:0},g(3,l=>t(e(_),{key:l,class:"card-compact"},{default:a(()=>[t(e(x),{class:"py-4 space-y-2"},{default:a(()=>[t(e(p),{class:"h-4 w-24"}),t(e(p),{class:"h-6 w-32"})]),_:1})]),_:1})),64)):(i(),c(v,{key:1},[t(e(_),{class:"card-compact"},{default:a(()=>[t(e(b),{class:"pb-2"},{default:a(()=>[t(e(W),null,{default:a(()=>[...s[12]||(s[12]=[d("Open Cases",-1)])]),_:1}),t(e(h),{class:"text-2xl"},{default:a(()=>[d(o(ve.value),1)]),_:1})]),_:1}),t(e(x),{class:"pt-0 text-xs text-muted-foreground"},{default:a(()=>[...s[13]||(s[13]=[d(" Cases in progress across all stages ",-1)])]),_:1})]),_:1}),t(e(_),{class:"card-compact"},{default:a(()=>[t(e(b),{class:"pb-2"},{default:a(()=>[t(e(W),null,{default:a(()=>[...s[14]||(s[14]=[d("Due Within 3 Days",-1)])]),_:1}),t(e(h),{class:"text-2xl"},{default:a(()=>[d(o(_e.value),1)]),_:1})]),_:1}),t(e(x),{class:"pt-0 text-xs text-muted-foreground"},{default:a(()=>[...s[15]||(s[15]=[d(" Evidence deadlines approaching ",-1)])]),_:1})]),_:1}),t(e(_),{class:"card-compact"},{default:a(()=>[t(e(b),{class:"pb-2"},{default:a(()=>[t(e(W),null,{default:a(()=>[...s[16]||(s[16]=[d("Win Rate (30d)",-1)])]),_:1}),t(e(h),{class:"text-2xl"},{default:a(()=>[d(o(pe.value),1)]),_:1})]),_:1}),t(e(x),{class:"pt-0 text-xs text-muted-foreground"},{default:a(()=>[...s[17]||(s[17]=[d(" Based on cases closed this month ",-1)])]),_:1})]),_:1})],64))]),e(H)?(i(),U(e(Ne),{key:0,variant:"destructive"},{default:a(()=>[t(e(je),null,{default:a(()=>[...s[18]||(s[18]=[d("Failed to load disputes",-1)])]),_:1}),t(e(Ie),null,{default:a(()=>[d(o(e(H)),1)]),_:1})]),_:1})):N("",!0),t(e(_),null,{default:a(()=>[e(Q)?(i(),c("div",et,[u("div",tt,[t(e(p),{class:"h-4 w-24"}),t(e(p),{class:"h-4 w-20"}),t(e(p),{class:"h-4 w-16 ml-auto"})]),u("div",st,[(i(),c(v,null,g(6,l=>u("div",{key:l,class:"grid grid-cols-12 items-center gap-4 py-3"},[t(e(p),{class:"col-span-2 h-4"}),t(e(p),{class:"col-span-3 h-4"}),t(e(p),{class:"col-span-2 h-4"}),t(e(p),{class:"col-span-2 h-4"}),t(e(p),{class:"col-span-2 h-6 rounded-full"}),t(e(p),{class:"col-span-1 h-4"})])),64))])])):(i(),c(v,{key:1},[G.value.length?(i(),U(e(Fe),{key:0,class:"table-compact","container-class":"px-4"},{default:a(()=>[t(e(Re),null,{default:a(()=>[t(e(ne),null,{default:a(()=>[t(e(S),null,{default:a(()=>[...s[19]||(s[19]=[d("Case ID",-1)])]),_:1}),t(e(S),null,{default:a(()=>[...s[20]||(s[20]=[d("Merchant",-1)])]),_:1}),t(e(S),null,{default:a(()=>[...s[21]||(s[21]=[d("Amount",-1)])]),_:1}),t(e(S),null,{default:a(()=>[...s[22]||(s[22]=[d("Reason",-1)])]),_:1}),t(e(S),null,{default:a(()=>[...s[23]||(s[23]=[d("Deadline",-1)])]),_:1}),t(e(S),null,{default:a(()=>[...s[24]||(s[24]=[d("Status",-1)])]),_:1})]),_:1})]),_:1}),t(e(Te),null,{default:a(()=>[(i(!0),c(v,null,g(G.value,l=>(i(),U(e(ne),{key:l.id,class:"cursor-pointer transition hover:bg-accent/5",onClick:m=>ye(l)},{default:a(()=>[t(e(V),null,{default:a(()=>[u("div",at,o(l.id),1),u("div",lt,[t(e(q),{variant:"outline"},{default:a(()=>[d(o(l.stage),1)]),_:2},1024),u("span",null,o(l.assignedTo),1)])]),_:2},1024),t(e(V),null,{default:a(()=>[u("div",nt,o(l.merchant.name),1),u("div",ot,o(l.merchant.dba)+" â€¢ "+o(l.merchant.mid),1)]),_:2},1024),t(e(V),{class:"font-mono"},{default:a(()=>[d(o(J(l.amount,l.currency)),1)]),_:2},1024),t(e(V),null,{default:a(()=>[u("div",ut,o(l.reason),1),u("div",dt,"Reason Code "+o(l.reasonCode),1)]),_:2},1024),t(e(V),null,{default:a(()=>[u("div",rt,o(M(l.deadline)),1),u("div",it,o(K(l.deadline)),1)]),_:2},1024),t(e(V),null,{default:a(()=>[t(oe,{variant:X(l.status)},{default:a(()=>[d(o(Y(l.status)),1)]),_:2},1032,["variant"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):(i(),c("div",ct,[t(Ee,{title:"No disputes match your filters",description:"Adjust filters or expand the date range to view other cases.",icon:e(Ve)},{actions:a(()=>[t(e(w),{variant:"outline",onClick:Z},{default:a(()=>[...s[25]||(s[25]=[d("Reset Filters",-1)])]),_:1})]),_:1},8,["icon"])]))],64))]),_:1}),F.value?(i(),c("div",mt,[u("div",ft," Showing "+o(me.value)+" to "+o(fe.value)+" of "+o(F.value)+" disputes ",1),t(e(qe),{total:F.value,"items-per-page":E,page:C.value,"onUpdate:page":s[4]||(s[4]=l=>C.value=l)},null,8,["total","page"])])):N("",!0),t(e(ze),{open:L.value,"onUpdate:open":s[6]||(s[6]=l=>L.value=l)},{default:a(()=>[t(e(Me),{class:"sm:max-w-2xl"},{default:a(()=>[r.value?(i(),c("div",vt,[t(e(Oe),{class:"space-y-2 text-left"},{default:a(()=>[t(e(Be),null,{default:a(()=>[d(o(r.value.id)+" â€¢ "+o(J(r.value.amount,r.value.currency)),1)]),_:1}),t(e(Pe),{class:"flex flex-wrap items-center gap-2"},{default:a(()=>[t(oe,{variant:X(r.value.status)},{default:a(()=>[d(o(Y(r.value.status)),1)]),_:1},8,["variant"]),t(e(q),{variant:"outline"},{default:a(()=>[d("Stage: "+o(r.value.stage),1)]),_:1}),u("span",_t,"Reason "+o(r.value.reasonCode),1),u("span",pt,"Deadline "+o(M(r.value.deadline)),1)]),_:1})]),_:1}),u("div",xt,[t(e(_),{class:"card-compact"},{default:a(()=>[t(e(b),{class:"pb-2"},{default:a(()=>[t(e(h),{class:"text-base"},{default:a(()=>[...s[26]||(s[26]=[d("Case Summary",-1)])]),_:1})]),_:1}),t(e(x),{class:"grid gap-3 sm:grid-cols-2"},{default:a(()=>[u("div",null,[s[27]||(s[27]=u("div",{class:"text-xs text-muted-foreground uppercase"},"Merchant",-1)),u("div",gt,o(r.value.merchant.name),1),u("div",yt,o(r.value.merchant.dba)+" â€¢ "+o(r.value.merchant.mid),1)]),u("div",null,[s[28]||(s[28]=u("div",{class:"text-xs text-muted-foreground uppercase"},"Assigned To",-1)),u("div",wt,o(r.value.assignedTo),1)]),u("div",null,[s[29]||(s[29]=u("div",{class:"text-xs text-muted-foreground uppercase"},"Transaction",-1)),u("div",bt,o(r.value.transaction.id),1),u("div",ht,o(O(r.value.transaction.processedAt))+" â€¢ "+o(r.value.transaction.cardBrand)+" â€¢ â€¢â€¢â€¢â€¢ "+o(r.value.transaction.cardLast4),1)]),u("div",null,[s[30]||(s[30]=u("div",{class:"text-xs text-muted-foreground uppercase"},"Reason",-1)),u("div",kt,o(r.value.reason),1)])]),_:1})]),_:1}),t(e(_),{class:"card-compact"},{default:a(()=>[t(e(b),{class:"pb-2 flex items-center justify-between"},{default:a(()=>[t(e(h),{class:"text-base"},{default:a(()=>[...s[31]||(s[31]=[d("Timeline",-1)])]),_:1}),t(e(q),{variant:"outline"},{default:a(()=>[d("Latest "+o(K(r.value.timeline[0]?.timestamp??r.value.deadline)),1)]),_:1})]),_:1}),t(e(x),{class:"space-y-4"},{default:a(()=>[(i(!0),c(v,null,g(r.value.timeline,l=>(i(),c("div",{key:l.id,class:"flex items-start gap-3"},[s[32]||(s[32]=u("div",{class:"mt-1 h-2 w-2 rounded-full bg-primary"},null,-1)),u("div",null,[u("div",$t,o(l.title),1),u("div",Dt,o(O(l.timestamp))+" â€¢ "+o(l.actor),1),u("p",Ct,o(l.description),1)])]))),128))]),_:1})]),_:1}),t(e(_),{class:"card-compact"},{default:a(()=>[t(e(b),{class:"pb-2"},{default:a(()=>[t(e(h),{class:"text-base"},{default:a(()=>[...s[33]||(s[33]=[d("Required Documents",-1)])]),_:1})]),_:1}),t(e(x),{class:"space-y-3"},{default:a(()=>[(i(!0),c(v,null,g(r.value.documents,(l,m)=>(i(),c("div",{key:l.name+"-"+m,class:"flex items-center justify-between rounded-md border border-border px-3 py-2"},[u("div",null,[u("div",St,o(l.name),1),l.uploadedAt?(i(),c("div",Vt,"Uploaded "+o(M(l.uploadedAt)),1)):N("",!0)]),t(e(q),{variant:xe(l.status)},{default:a(()=>[d(o(ge(l.status)),1)]),_:2},1032,["variant"])]))),128)),u("div",At,[t(e(w),{variant:"outline",size:"sm",onClick:be},{default:a(()=>[t(e(Je),{class:"mr-2 h-4 w-4"}),s[34]||(s[34]=d(" Request Document ",-1))]),_:1})])]),_:1})]),_:1}),t(e(_),{class:"card-compact"},{default:a(()=>[t(e(b),{class:"pb-2"},{default:a(()=>[t(e(h),{class:"text-base"},{default:a(()=>[...s[35]||(s[35]=[d("Evidence",-1)])]),_:1})]),_:1}),t(e(x),{class:"space-y-3"},{default:a(()=>[r.value.evidence.length?(i(),c("div",Rt,[(i(!0),c(v,null,g(r.value.evidence,(l,m)=>(i(),c("div",{key:l.name+"-"+m,class:"flex items-center justify-between rounded-md border border-border px-3 py-2"},[u("div",null,[u("div",Tt,o(l.name),1),u("div",Ft,"Uploaded "+o(O(l.uploadedAt))+" â€¢ "+o(l.size),1)]),t(e(w),{variant:"ghost",size:"sm"},{default:a(()=>[...s[36]||(s[36]=[d("View",-1)])]),_:1})]))),128))])):(i(),c("div",Ut,"No evidence uploaded yet.")),u("div",qt,[t(e(w),{size:"sm",onClick:he},{default:a(()=>[...s[37]||(s[37]=[d("Upload Evidence",-1)])]),_:1})])]),_:1})]),_:1}),t(e(_),{class:"card-compact"},{default:a(()=>[t(e(b),{class:"pb-2 flex items-center justify-between"},{default:a(()=>[t(e(h),{class:"text-base"},{default:a(()=>[...s[38]||(s[38]=[d("Notes",-1)])]),_:1}),t(e(q),{variant:"outline"},{default:a(()=>[...s[39]||(s[39]=[d("Internal",-1)])]),_:1})]),_:1}),t(e(x),{class:"space-y-3"},{default:a(()=>[t(e(We),{modelValue:R.value,"onUpdate:modelValue":s[5]||(s[5]=l=>R.value=l),placeholder:"Add context for teammates...",rows:"4"},null,8,["modelValue"]),u("div",Et,[t(e(w),{variant:"outline",size:"sm",onClick:$e},{default:a(()=>[...s[40]||(s[40]=[d("Reset",-1)])]),_:1}),t(e(w),{size:"sm",onClick:ke},{default:a(()=>[...s[41]||(s[41]=[d("Save Note",-1)])]),_:1})])]),_:1})]),_:1})])])):N("",!0)]),_:1})]),_:1},8,["open"])]))}});export{es as default};
