import{d as B,r as p,o as E,c as v,b as d,e as t,j as b,y as C,z as q,f as k,u as i,A as Q,B as S,C as X,i as l,t as a,F as L,m as N,X as G,q as I,x as H,h as n}from"./index-CBlyhhB_.js";import{u as J}from"./paymentsStore-DGeoRBLV.js";import{C as R}from"./chevron-down-CAD7_O72.js";import{D as K}from"./download-CZMehmmv.js";const O={class:"dark:bg-gray-900"},W={class:"mb-6 flex justify-between items-center"},Y={class:"flex space-x-2"},Z={class:"relative"},tt={class:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},et={class:"relative"},st={class:"relative"},at={class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 text-white font-medium rounded-lg transition-colors"},rt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden"},ot={key:0,class:"flex justify-center items-center h-64"},dt={key:1,class:"text-red-500 dark:text-red-400 text-center py-8"},nt={key:2,class:"text-center py-8 text-gray-500 dark:text-gray-400"},lt={key:3},it={class:"overflow-x-auto"},ut={class:"w-full border-collapse"},pt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},gt={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},yt={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},xt={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ct={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},vt={key:0},bt={key:1},kt={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},mt={class:"px-6 py-4 whitespace-nowrap"},ft={class:"px-6 py-4 whitespace-nowrap dark:text-gray-200"},ht={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},wt=["onClick"],_t=["onClick"],Ct={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-between items-center border-t border-gray-200 dark:border-gray-600"},Tt={class:"text-sm text-gray-500 dark:text-gray-400"},Dt={class:"font-medium"},Pt={class:"font-medium"},St={class:"font-medium"},Lt={class:"flex space-x-2"},Nt=["disabled"],It=["disabled"],Rt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},$t={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-3xl w-full mx-4"},Mt={class:"flex justify-between items-center mb-4"},Vt={key:0,class:"text-sm"},At={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Ft={class:"font-medium dark:text-white"},zt={class:"font-medium dark:text-white"},jt={class:"font-medium dark:text-white"},Ut={class:"font-medium"},Bt={class:"font-medium dark:text-white"},Et={class:"font-medium dark:text-white"},qt={key:0},Qt={key:1},Xt={class:"font-medium dark:text-white"},Gt={class:"font-medium dark:text-white"},Ht={class:"font-medium dark:text-white"},Jt={class:"font-medium dark:text-white"},Kt={class:"mt-6"},Ot={key:0,class:"bg-gray-50 dark:bg-gray-700 p-3 rounded"},Wt={class:"dark:text-white"},Yt={class:"dark:text-white"},Zt={key:1,class:"text-gray-500 dark:text-gray-400"},te={key:0,class:"mt-6"},ee={class:"bg-gray-50 dark:bg-gray-700 p-3 rounded"},se={class:"dark:text-white"},ae={class:"dark:text-white"},re={class:"dark:text-white"},oe={class:"dark:text-white"},de={class:"dark:text-white"},ne={class:"mt-6 flex justify-end gap-3"},ye=B({__name:"TransactionsView",setup(le){const $=H(),y=J(),{isLoading:M,error:T,fetchTransactions:V}=y,u=p(1),x=p(10),m=p(""),f=p("all"),h=p("all"),c=p(!1),o=p(null);E(async()=>{try{await V()}catch(r){console.error("Error fetching transactions:",r)}});const g=v(()=>{if(!y.transactions||y.transactions.length===0)return[];let r=[...y.transactions];if(f.value!=="all"&&(r=r.filter(e=>e.status.toLowerCase()===f.value.toLowerCase())),h.value==="card_present"?r=r.filter(e=>e.isCardPresent):h.value==="card_not_present"&&(r=r.filter(e=>!e.isCardPresent)),m.value){const e=m.value.toLowerCase();r=r.filter(s=>s.id.toLowerCase().includes(e)||s.customerId.toLowerCase().includes(e)||s.paymentMethodName.toLowerCase().includes(e)||s.cardLast4&&s.cardLast4.includes(e))}return r.sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime())}),A=v(()=>{const r=(u.value-1)*x.value,e=r+x.value;return g.value.slice(r,e)}),F=v(()=>Math.ceil(g.value.length/x.value)),z=v(()=>(u.value-1)*x.value+1),j=v(()=>{const r=u.value*x.value;return r>g.value.length?g.value.length:r}),w=r=>{const e=new Date(r);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)},D=r=>{switch(r){case"captured":case"settled":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"authorized":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"failed":case"voided":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";case"refunded":case"partially_refunded":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},U=r=>{const e=y.getTransactionById(r);e&&(o.value=e,c.value=!0)},P=r=>{console.log(`Initiating refund for transaction ${r}`),$.push(`/payments/refunds/new?transactionId=${r}`)};return(r,e)=>(n(),d("div",O,[t("header",W,[e[11]||(e[11]=t("div",null,[t("h1",{class:"text-3xl font-bold dark:text-white"},"Payment Transactions"),t("p",{class:"text-gray-500 dark:text-gray-400 mt-2"},"View and manage all payment transactions")],-1)),t("div",Y,[t("div",Z,[C(t("input",{type:"text",placeholder:"Search transactions...",class:"px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s)},null,512),[[q,m.value]]),t("button",tt,[k(i(Q),{class:"w-5 h-5"})])]),t("div",et,[C(t("select",{class:"appearance-none px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8","onUpdate:modelValue":e[1]||(e[1]=s=>f.value=s)},e[8]||(e[8]=[X('<option value="all">All Statuses</option><option value="authorized">Authorized</option><option value="captured">Captured</option><option value="settled">Settled</option><option value="failed">Failed</option><option value="voided">Voided</option><option value="refunded">Refunded</option><option value="partially_refunded">Partially Refunded</option>',8)]),512),[[S,f.value]]),k(i(R),{class:"absolute right-3 top-3 w-4 h-4 text-gray-400 pointer-events-none"})]),t("div",st,[C(t("select",{class:"appearance-none px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8","onUpdate:modelValue":e[2]||(e[2]=s=>h.value=s)},e[9]||(e[9]=[t("option",{value:"all"},"All Types",-1),t("option",{value:"card_present"},"Card Present",-1),t("option",{value:"card_not_present"},"Card Not Present",-1)]),512),[[S,h.value]]),k(i(R),{class:"absolute right-3 top-3 w-4 h-4 text-gray-400 pointer-events-none"})]),t("button",at,[k(i(K),{class:"w-5 h-5 mr-1 inline-block"}),e[10]||(e[10]=l(" Export "))])])]),t("section",rt,[i(M)?(n(),d("div",ot,e[12]||(e[12]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-100"},null,-1)]))):i(T)?(n(),d("div",dt,a(i(T)),1)):g.value.length===0?(n(),d("div",nt," No transactions found. ")):(n(),d("div",lt,[t("div",it,[t("table",ut,[e[13]||(e[13]=t("thead",null,[t("tr",{class:"bg-gray-50 dark:bg-gray-700 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},[t("th",{class:"px-6 py-3"},"Transaction ID"),t("th",{class:"px-6 py-3"},"Date"),t("th",{class:"px-6 py-3"},"Payment Method"),t("th",{class:"px-6 py-3"},"Card Info"),t("th",{class:"px-6 py-3"},"Amount"),t("th",{class:"px-6 py-3"},"Status"),t("th",{class:"px-6 py-3"},"Type"),t("th",{class:"px-6 py-3"},"Actions")])],-1)),t("tbody",pt,[(n(!0),d(L,null,N(A.value,s=>(n(),d("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",gt,a(s.id),1),t("td",yt,a(w(s.date)),1),t("td",xt,a(s.paymentMethodName),1),t("td",ct,[s.cardType&&s.cardLast4?(n(),d("span",vt,a(s.cardType.toUpperCase())+" •••• "+a(s.cardLast4),1)):(n(),d("span",bt,"—"))]),t("td",kt,"$"+a(s.amount.toFixed(2)),1),t("td",mt,[t("span",{class:I(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",D(s.status)])},a(s.status),3)]),t("td",ft,a(s.isCardPresent?"Card Present":"Card Not Present"),1),t("td",ht,[t("button",{class:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3",onClick:_=>U(s.id)}," Details ",8,wt),["captured","settled"].includes(s.status)?(n(),d("button",{key:0,class:"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300",onClick:_=>P(s.id)}," Refund ",8,_t)):b("",!0)])]))),128))])])]),t("div",Ct,[t("div",Tt,[e[14]||(e[14]=l(" Showing ")),t("span",Dt,a(z.value),1),e[15]||(e[15]=l(" to ")),t("span",Pt,a(j.value),1),e[16]||(e[16]=l(" of ")),t("span",St,a(g.value.length),1),e[17]||(e[17]=l(" transactions "))]),t("div",Lt,[t("button",{class:"px-3 py-1 rounded border border-gray-300 dark:border-gray-600 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:u.value===1,onClick:e[3]||(e[3]=s=>u.value--)}," Previous ",8,Nt),t("button",{class:"px-3 py-1 rounded border border-gray-300 dark:border-gray-600 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:u.value===F.value,onClick:e[4]||(e[4]=s=>u.value++)}," Next ",8,It)])])]))]),c.value?(n(),d("div",Rt,[t("div",$t,[t("div",Mt,[e[18]||(e[18]=t("h3",{class:"text-xl font-bold dark:text-white"},"Transaction Details",-1)),t("button",{onClick:e[5]||(e[5]=s=>c.value=!1),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"},[k(i(G),{class:"w-5 h-5"})])]),o.value?(n(),d("div",Vt,[t("div",At,[t("div",null,[e[19]||(e[19]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Transaction ID",-1)),t("p",Ft,a(o.value.id),1)]),t("div",null,[e[20]||(e[20]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Date",-1)),t("p",zt,a(w(o.value.date)),1)]),t("div",null,[e[21]||(e[21]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Amount",-1)),t("p",jt,"$"+a(o.value.amount.toFixed(2)),1)]),t("div",null,[e[22]||(e[22]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Status",-1)),t("p",Ut,[t("span",{class:I(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",D(o.value.status)])},a(o.value.status),3)])]),t("div",null,[e[23]||(e[23]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Payment Method",-1)),t("p",Bt,a(o.value.paymentMethodName),1)]),t("div",null,[e[24]||(e[24]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Card Information",-1)),t("p",Et,[o.value.cardType&&o.value.cardLast4?(n(),d("span",qt,a(o.value.cardType.toUpperCase())+" •••• "+a(o.value.cardLast4),1)):(n(),d("span",Qt,"—"))])]),t("div",null,[e[25]||(e[25]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Transaction Type",-1)),t("p",Xt,a(o.value.isCardPresent?"Card Present":"Card Not Present"),1)]),t("div",null,[e[26]||(e[26]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Authorization Code",-1)),t("p",Gt,a(o.value.authorizationCode||"—"),1)]),t("div",null,[e[27]||(e[27]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Customer ID",-1)),t("p",Ht,a(o.value.customerId),1)]),t("div",null,[e[28]||(e[28]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-1"},"Employee ID",-1)),t("p",Jt,a(o.value.employeeId),1)])]),t("div",Kt,[e[31]||(e[31]=t("h4",{class:"font-bold mb-2 dark:text-white"},"Processor Response",-1)),o.value.processorResponse?(n(),d("div",Ot,[t("p",Wt,[e[29]||(e[29]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Code:",-1)),l(" "+a(o.value.processorResponse.code),1)]),t("p",Yt,[e[30]||(e[30]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Message:",-1)),l(" "+a(o.value.processorResponse.message),1)])])):(n(),d("p",Zt,"No processor response available"))]),o.value.refunds&&o.value.refunds.length>0?(n(),d("div",te,[e[37]||(e[37]=t("h4",{class:"font-bold mb-2 dark:text-white"},"Refunds",-1)),t("div",ee,[(n(!0),d(L,null,N(o.value.refunds,(s,_)=>(n(),d("div",{key:_,class:"mb-2 pb-2 border-b border-gray-200 dark:border-gray-600 last:border-0 last:mb-0 last:pb-0"},[t("p",se,[e[32]||(e[32]=t("span",{class:"text-gray-500 dark:text-gray-400"},"ID:",-1)),l(" "+a(s.id),1)]),t("p",ae,[e[33]||(e[33]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Date:",-1)),l(" "+a(w(s.date)),1)]),t("p",re,[e[34]||(e[34]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Amount:",-1)),l(" $"+a(s.amount.toFixed(2)),1)]),t("p",oe,[e[35]||(e[35]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Status:",-1)),l(" "+a(s.status),1)]),t("p",de,[e[36]||(e[36]=t("span",{class:"text-gray-500 dark:text-gray-400"},"Reason:",-1)),l(" "+a(s.reason),1)])]))),128))])])):b("",!0),t("div",ne,[t("button",{onClick:e[6]||(e[6]=s=>c.value=!1),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}," Close "),["captured","settled"].includes(o.value.status)?(n(),d("button",{key:0,onClick:e[7]||(e[7]=s=>{P(o.value.id),c.value=!1}),class:"px-4 py-2 bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-lg"}," Process Refund ")):b("",!0)])])):b("",!0)])])):b("",!0)]))}});export{ye as default};
